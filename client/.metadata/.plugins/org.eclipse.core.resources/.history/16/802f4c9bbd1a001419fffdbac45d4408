package com.ui
{
    import flash.display.*;
    import flash.text.*;

    public class FloaterMe extends Sprite
    {
        private var _openTxt:TextField;
        private var _percentTxt:TextField;
        public var w:uint = 110;
        private var _openNumTxt:TextField;
        private var _lowTxt:TextField;
        private var _turnoverTxt:TextField;
        private var _dateTxt:TextField;
        private var _cfg:Config;
        private var _volumeNumTxt:TextField;
        private var _fallRiseTxt:TextField;
        private var _highTxt:TextField;
        private var _percentNumTxt:TextField;
        private var _closeTxt:TextField;
        private var _fallRiseNumTxt:TextField;
        private var _reTxt:TextField;
        private var _lbX:uint = 2;
        private var _h:uint = 155;
        private var _closeNumTxt:TextField;
        private var _highNumTxt:TextField;
        private var _numX:uint = 42;
        private var _turnoverNumTxt:TextField;
        private var _volumeTxt:TextField;
        private var _lowNumTxt:TextField;

        public function FloaterMe()
        {
            this._cfg = Config.getInstance();
            this.mouseEnabled = false;
            this._h = this._cfg.stockType == "i" ? (143) : (155);
            this.drawBorderBg();
            this.layoutTxt();
            return;
        }// end function

        public function setData(param1:Object) : void
        {
            this._dateTxt.text = param1.date.fullYear + "-" + ((param1.date.month + 1) < 10 ? ("0" + (param1.date.month + 1)) : ((param1.date.month + 1))) + "-" + (param1.date.date < 10 ? ("0" + param1.date.date) : (param1.date.date)) + " 周" + this.numToCn(param1.date.day);
            var _loc_2:String = "";
            if (this._cfg.reDirection == "f")
            {
                _loc_2 = "[前复权]";
            }
            else if (this._cfg.reDirection == "b")
            {
                _loc_2 = "[后复权]";
            }
            this._reTxt.text = _loc_2;
            this._reTxt.textColor = 16384512;
            this._openNumTxt.text = param1.open;
            this._highNumTxt.text = param1.high;
            this._lowNumTxt.text = param1.low;
            this._closeNumTxt.text = param1.close;
            this._percentNumTxt.text = param1.percent;
            this._volumeNumTxt.text = param1.volume;
            if (this._turnoverNumTxt)
            {
                this._turnoverNumTxt.text = param1.capital ? (Number(param1.volumeNum / param1.capital).toFixed(2) + "%") : ("--");
            }
            var _loc_3:* = this._cfg.cfontBlack;
            var _loc_4:* = Number(String(param1.percent).substr(0, -1));
            if (Number(String(param1.percent).substr(0, -1)) > 0)
            {
                _loc_3 = this._cfg.cfontRise;
            }
            else if (_loc_4 < 0)
            {
                _loc_3 = this._cfg.cfontFall;
            }
            this._percentNumTxt.textColor = _loc_3;
            var _loc_5:* = param1.close / (1 + _loc_4 / 100);
            var _loc_6:* = Number(param1.close - _loc_5).toFixed(2);
            this._fallRiseNumTxt.text = _loc_6;
            this._fallRiseNumTxt.textColor = _loc_3;
            _loc_3 = this._cfg.cfontBlack;
            if (param1.open > _loc_5)
            {
                _loc_3 = this._cfg.cfontRise;
            }
            else if (param1.open < _loc_5)
            {
                _loc_3 = this._cfg.cfontFall;
            }
            this._openNumTxt.textColor = _loc_3;
            _loc_3 = this._cfg.cfontBlack;
            if (param1.high > _loc_5)
            {
                _loc_3 = this._cfg.cfontRise;
            }
            else if (param1.high < _loc_5)
            {
                _loc_3 = this._cfg.cfontFall;
            }
            this._highNumTxt.textColor = _loc_3;
            _loc_3 = this._cfg.cfontBlack;
            if (param1.low < _loc_5)
            {
                _loc_3 = this._cfg.cfontFall;
            }
            else if (param1.low > _loc_5)
            {
                _loc_3 = this._cfg.cfontRise;
            }
            this._lowNumTxt.textColor = _loc_3;
            _loc_3 = this._cfg.cfontBlack;
            if (param1.close > _loc_5)
            {
                _loc_3 = this._cfg.cfontRise;
            }
            else if (param1.close < _loc_5)
            {
                _loc_3 = this._cfg.cfontFall;
            }
            this._closeNumTxt.textColor = _loc_3;
            return;
        }// end function

        private function newTxtField(param1:String = "", param2:Boolean = false, param3:Boolean = false) : TextField
        {
            var _loc_4:* = new TextField();
            new TextField().mouseEnabled = false;
            _loc_4.height = 20;
            _loc_4.width = this.w - 5;
            var _loc_5:* = new TextFormat("arial", 12, 0);
            if (param2)
            {
                _loc_4.width = this.w - this._numX - this._lbX;
                _loc_5.align = TextFormatAlign.RIGHT;
            }
            if (param3)
            {
                _loc_4.width = this.w;
                _loc_5.align = TextFormatAlign.CENTER;
            }
            _loc_4.defaultTextFormat = _loc_5;
            _loc_4.text = param1;
            return _loc_4;
        }// end function

        private function layoutTxt() : void
        {
            this._dateTxt = this.newTxtField("", false, true);
            this._dateTxt.x = 0;
            this._dateTxt.y = 1;
            addChild(this._dateTxt);
            this._reTxt = this.newTxtField("", true, false);
            this._reTxt.x = this._numX;
            this._reTxt.y = 14;
            addChild(this._reTxt);
            var _loc_1:uint = 28;
            var _loc_2:uint = 15;
            this._openTxt = this.newTxtField("开盘价:");
            this._openTxt.x = this._lbX;
            this._openTxt.y = _loc_1;
            addChild(this._openTxt);
            this._openNumTxt = this.newTxtField("", true);
            this._openNumTxt.x = this._numX;
            this._openNumTxt.y = _loc_1;
            addChild(this._openNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._highTxt = this.newTxtField("最高价:");
            this._highTxt.x = this._lbX;
            this._highTxt.y = _loc_1;
            addChild(this._highTxt);
            this._highNumTxt = this.newTxtField("", true);
            this._highNumTxt.x = this._numX;
            this._highNumTxt.y = _loc_1;
            addChild(this._highNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._lowTxt = this.newTxtField("最低价:");
            this._lowTxt.x = this._lbX;
            this._lowTxt.y = _loc_1;
            addChild(this._lowTxt);
            this._lowNumTxt = this.newTxtField("", true);
            this._lowNumTxt.x = this._numX;
            this._lowNumTxt.y = _loc_1;
            addChild(this._lowNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._closeTxt = this.newTxtField("收盘价:");
            this._closeTxt.x = this._lbX;
            this._closeTxt.y = _loc_1;
            addChild(this._closeTxt);
            this._closeNumTxt = this.newTxtField("", true);
            this._closeNumTxt.x = this._numX;
            this._closeNumTxt.y = _loc_1;
            addChild(this._closeNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._fallRiseTxt = this.newTxtField("涨跌额:");
            this._fallRiseTxt.x = this._lbX;
            this._fallRiseTxt.y = _loc_1;
            addChild(this._fallRiseTxt);
            this._fallRiseNumTxt = this.newTxtField("", true);
            this._fallRiseNumTxt.x = this._numX;
            this._fallRiseNumTxt.y = _loc_1;
            addChild(this._fallRiseNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._percentTxt = this.newTxtField("涨跌幅:");
            this._percentTxt.x = this._lbX;
            this._percentTxt.y = _loc_1;
            addChild(this._percentTxt);
            this._percentNumTxt = this.newTxtField("", true);
            this._percentNumTxt.x = this._numX;
            this._percentNumTxt.y = _loc_1;
            addChild(this._percentNumTxt);
            _loc_1 = _loc_1 + _loc_2;
            this._volumeTxt = this.newTxtField("成交量:");
            this._volumeTxt.x = this._lbX;
            this._volumeTxt.y = _loc_1;
            addChild(this._volumeTxt);
            this._volumeNumTxt = this.newTxtField("", true);
            this._volumeNumTxt.x = this._numX;
            this._volumeNumTxt.y = _loc_1;
            addChild(this._volumeNumTxt);
            if (this._cfg.stockType == "i")
            {
                return;
            }
            _loc_1 = _loc_1 + _loc_2;
            this._turnoverTxt = this.newTxtField("换手率:");
            this._turnoverTxt.x = this._lbX;
            this._turnoverTxt.y = _loc_1;
            addChild(this._turnoverTxt);
            this._turnoverNumTxt = this.newTxtField("", true);
            this._turnoverNumTxt.x = this._numX;
            this._turnoverNumTxt.y = _loc_1;
            addChild(this._turnoverNumTxt);
            return;
        }// end function

        private function numToCn(param1:uint) : String
        {
            var _loc_2:String = "";
            switch(param1)
            {
                case 1:
                {
                    _loc_2 = "一";
                    break;
                }
                case 2:
                {
                    _loc_2 = "二";
                    break;
                }
                case 3:
                {
                    _loc_2 = "三";
                    break;
                }
                case 4:
                {
                    _loc_2 = "四";
                    break;
                }
                case 5:
                {
                    _loc_2 = "五";
                    break;
                }
                case 6:
                {
                    _loc_2 = "六";
                    break;
                }
                case 7:
                {
                    _loc_2 = "日";
                    break;
                }
                default:
                {
                    break;
                }
            }
            return _loc_2;
        }// end function

        private function drawBorderBg() : void
        {
            this.graphics.lineStyle(0, 0, 0.3);
            this.graphics.beginFill(16777215, 0.9);
            this.graphics.drawRect(0, 0, this.w, this._h);
            this.graphics.endFill();
            return;
        }// end function

    }
}
